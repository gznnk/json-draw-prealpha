# フォルダ構成ガイド

このドキュメントは、プロジェクト内の主要なフォルダの構造と責務を明確にするためのガイドです。  
機能の境界や再利用可能なモジュール、インフラ系コードの区別を明確にし、大規模開発・AI補助開発において保守性を高めます。

---

## `/app`

アプリケーションのルート構成を担うコード。`features/` や `shared/` を組み合わせて、実際の画面や操作を構成します。

- `components/`: アプリ固有のUI部品。再利用を前提としない構成パーツ。
- `models/`: アプリ全体で使うデータ構造（型定義など）。ドメインロジックを持たない。
- `repository/`: 外部APIやデータとの通信を担当するレイヤー。
- `tools/`: **キャンバス操作やAIワークフロー用の内部処理ロジックモジュール。**  
  例：ノードの追加、下書きの作成、埋め込みエージェントの起動など、機能単位の小さな処理。

---

## `/features`

1つの機能やユースケースに閉じた自己完結型のフォルダ。UI・状態管理・ロジックをまとめて構成します。

### 責務:
- 特定の機能に必要なすべてのコード（UI/ロジック/型など）を持つ
- 他の feature には依存しない（疎結合）
- `shared`, `lib`, `models` には依存してOK

### 例:
- `llm-chat-ui/`: LLMチャット機能
- `markdown-editor/`: Markdown編集機能
- `svg-canvas/`: 図形キャンバス機能

---

## `/shared`

複数の feature や `app/` から再利用される、汎用的でユースケース非依存なモジュールを格納します。

### 責務:
- 汎用UIコンポーネント（例：Button, Modal）
- フック、ユーティリティ関数、型定義など
- 特定のユースケースに依存しない
- `features/` や `app/` から利用されるが、それらに依存しない

### 例:
- `shared/llm-client`: OpenAI等のクライアント（複数の機能で利用）
- `shared/markdown`: Markdownパーサーやレンダラー、ユーティリティ

---

## `/lib`

外部サービスやインフラとの接続・初期化処理を行う低レイヤーのモジュールを格納します。

### 責務:
- axios や Firebase、OpenAI などの初期化・設定
- 認証やエラーハンドリングのミドルウェア
- `shared` や `features` から利用される想定

---

## `/utils`

ステートレスでUIにも依存しない、軽量なユーティリティ関数群。  
必要に応じて `shared/utils/` に統合しても構いません。

---

## モジュール依存関係図

```mermaid
graph TD
    features --> shared
    features --> lib
    features --> models
    app --> features
    app --> shared
    app --> lib
    app --> models